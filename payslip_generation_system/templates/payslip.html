{% extends "includes/base.html" %}

{% block title %}DENR NCR - PaGeS{% endblock title %}
{% load humanize %}
{% block content %}
<style>
    .payslip-container {
        width: 100%;
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        overflow-x: auto;
    }

    .payslip-header {
        text-align: center;
        margin-bottom: 20px;
    }

    .payslip-header h2 {
        margin-bottom: 0;
    }

    .payslip-header p {
        font-size: 14px;
        color: gray;
    }

    .table th {
        background-color: #f1f1f1;
    }

    .table td, .table th {
        padding: 10px;
        white-space: nowrap;
    }

    .footer {
        margin-top: 30px;
        text-align: center;
        font-size: 12px;
        color: gray;
    }

    @media print {
        @page {
            size: landscape;
            margin: 20mm;
        }

        body {
            -webkit-print-color-adjust: exact;
        }

        .payslip-container {
            width: 100%;
        }

        .btn, form {
            display: none;
        }
    }
</style>


<form method="POST">
    {% csrf_token %}
    <div class="form-group">
        <label for="employeeSelect">Employee</label>
        <select class="form-select" id="employeeSelect" name="employee" required>
            <option value="" disabled selected>-- Select Employee --</option>
            {% for employee in employees %}
                <option value="{{ employee.id }}">{{ employee.fullname }} - {{ employee.position }}</option>
            {% endfor %}
        </select>
    </div>
    
    <div class="form-group">
        <label for="monthSelect">Month</label>
        <select class="form-select" id="monthSelect" name="month" required>
            <option value="" disabled selected>-- Select Month --</option>
            {% for month, month_name in month_choices %}
                <option value="{{ month }}" {% if month == current_month %}selected{% endif %}>{{ month_name }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="form-group">
        <label for="cutoffSelect">Cutoff</label>
        <select class="form-select" id="cutoffSelect" name="cutoff" required>
            <option value="1st">1st</option>
            <option value="2nd">2nd</option>
        </select>
    </div>

    <button type="submit" class="btn btn-primary">Generate Payslip</button>
</form>

<div class="payslip-container">
    <div class="payslip-header">
        <h2>Employee Payslip</h2>
        <p>Company Name</p>
        <p>Address Line 1, Address Line 2</p>
        <p>Phone: (123) 456-7890 | Email: example@company.com</p>
    </div>

    
    <div class="row">
        <div class="col-md-6">
            <table class="table table-bordered">
                <tbody>
                    <tr>
                        <th>Employee Name</th>
                        <td>{{ employee_name }}</td>
                    </tr>
                    <tr>
                        <th>Position</th>
                        <td>{{ position }}</td>
                    </tr>
                    <tr>
                        <th>Employee ID</th>
                        <td>{{ employee_id }}</td>
                    </tr>
                    <tr>
                        <th>Salary Period</th>
                        <td>{{ salary_period }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    
        <div class="col-md-6">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th colspan="2" class="text-center">Summary</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Basic Salary Gross</td>
                        <td>₱{{ basic_salary|floatformat:2|intcomma }}</td>
                    </tr>
                    <tr>
                        <td>1st Cut Off Net Pay</td>
                        <td>₱{{ net_pay_first|floatformat:2|intcomma }}</td>
                    </tr>
                    <tr>
                        <td>2nd Cut Off Net Pay</td>
                        <td>₱{{ net_pay_second|floatformat:2|intcomma }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-6">
            <table class="table table-bordered">
                <thead>
                    <tr><th colspan="2" class="text-center">Deductions</th></tr>
                </thead>
                <tbody>
                    <tr><td>TAX</td><td>₱{{ tax_deduction|floatformat:2|intcomma }}</td></tr>
                    <tr><td>Philhealth</td><td>₱{{ philhealth|floatformat:2|intcomma }}</td></tr>
                    <tr><td>Late / Absences ({{ late_min_total }} minutes)</td><td>₱{{ late_amt_total|floatformat:2|intcomma }}</td></tr>
                    <tr><td>Adjustments</td><td>₱{{ adjustments_minus|floatformat:2|intcomma }}</td></tr>
                    <tr><td><strong>Total Deductions</strong></td><td><strong>₱{{ total_deductions|floatformat:2|intcomma }}</strong></td></tr>
                </tbody>
            </table>
        </div>
    
        <div class="col-md-6">
            <table class="table table-bordered">
                <thead>
                    <tr><th colspan="2" class="text-center">Adjustments</th></tr>
                </thead>
                <tbody>
                    <tr><td>Adjustments</td><td>₱{{ adjustments_add|floatformat:2|intcomma }}</td></tr>
                    <tr><td><strong>Total Adjustment</strong></td><td><strong>₱{{ adjustments_add|floatformat:2|intcomma }}</strong></td></tr>
                </tbody>
            </table>
        </div>
    </div>
    
    

    <div class="footer">
        <p>Generated on: {{ current_date }}</p>
        <p>Company Confidential</p>
    </div>
</div>
{% endblock %}